<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:title" content="Kenthir AI Pro - Generator Seni AI">
    <meta property="og:description" content="Buat karya seni menakjubkan dari teks dengan teknologi AI canggih. Gratis, cepat, dan mudah digunakan!">
    <meta property="og:image" content="assets/kenthir.webp">
    <title>AI Art Generator | Flux-Turbo by Pollinations</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&family=Montserrat:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
       :root {
    --primary: #7E57C2;
    --primary-dark: #5E35B1;
    --secondary: #26C6DA;
    --accent: #FFA000;
    --light: #F5F5F7;
    --dark: #263238;
    --success: #66BB6A;
    --warning: #FFA726;
    --error: #EF5350;
    --border-radius: 12px;
    --box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    --transition: all 0.3s ease;
    
    /* Dark mode variables */
    --bg-color: #F5F5F7;
    --text-color: #263238;
    --card-bg: white;
    --input-bg: white;
    --border-color: #e0e0e0;
    --gallery-bg: white;
    --gallery-border: #eee;
}

/* Dark mode styles */
body.dark-mode {
    --bg-color: #121212;
    --text-color: #e0e0e0;
    --card-bg: #1E1E1E;
    --input-bg: #2D2D2D;
    --border-color: #444;
    --light: #1E1E1E;
    --dark: #e0e0e0;
    --gallery-bg: #2D2D2D;
    --gallery-border: #444;
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: 'Poppins', sans-serif;
    background-color: var(--bg-color);
    color: var(--text-color);
    line-height: 1.6;
    padding: 1rem;
    transition: var(--transition);
}

.container {
    max-width: 1200px;
    margin: 1rem auto;
    padding: 1.5rem;
    background: var(--card-bg);
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    transition: var(--transition);
}

header {
    text-align: center;
    margin-bottom: 1.5rem;
    position: relative;
}

h1 {
    font-family: 'Montserrat', sans-serif;
    color: var(--primary-dark);
    margin-bottom: 0.5rem;
    font-size: clamp(1.8rem, 4vw, 2.5rem);
}

.subtitle {
    color: var(--primary);
    font-weight: 400;
    margin-bottom: 1rem;
    font-size: clamp(0.9rem, 2vw, 1.1rem);
}

.generator-form {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.form-group.full-width {
    grid-column: span 1;
}

.form-group {
    margin-bottom: 1rem;
    position: relative;
}

label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 500;
    color: var(--text-color);
    font-size: clamp(0.9rem, 2vw, 1rem);
}

.input-icon {
    position: relative;
}

.input-icon i {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--primary);
    font-size: clamp(0.9rem, 2vw, 1rem);
}

.input-icon input,
.input-icon textarea,
.input-icon select {
    padding-left: 40px !important;
    width: 100%;
}

textarea, select, input {
    width: 100%;
    padding: 0.75rem;
    border: 2px solid var(--border-color);
    border-radius: 8px;
    font-family: 'Poppins', sans-serif;
    transition: var(--transition);
    font-size: 1rem;
    background-color: var(--input-bg);
    color: var(--text-color);
}

textarea:focus, select:focus, input:focus {
    border-color: var(--primary);
    outline: none;
    box-shadow: 0 0 0 3px rgba(126, 87, 194, 0.2);
}

textarea {
    min-height: 120px;
    resize: vertical;
}

button {
    background-color: var(--primary);
    color: white;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    cursor: pointer;
    font-size: clamp(0.9rem, 2vw, 1rem);
    font-weight: 500;
    transition: var(--transition);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    touch-action: manipulation; /* Mencegah delay pada touch devices */
}

button:hover {
    background-color: var(--primary-dark);
    transform: translateY(-2px);
}

button:disabled {
    background-color: #cccccc;
    cursor: not-allowed;
    transform: none;
}

.btn-generate {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    font-weight: 600;
    padding: 0.9rem 1.8rem;
    margin-top: 0.5rem;
    width: 100%;
}

.btn-clear {
    background-color: var(--warning);
}

.result-container {
    margin-top: 1.5rem;
    text-align: center;
}

.loading {
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 1.5rem;
    background: rgba(126, 87, 194, 0.1);
    border-radius: 8px;
    margin-bottom: 1rem;
}

.loading-spinner {
    border: 4px solid rgba(126, 87, 194, 0.2);
    border-top: 4px solid var(--primary);
    border-radius: 50%;
    width: 40px;
    height: 40px;
    animation: spin 1s linear infinite;
    margin-bottom: 1rem;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.loading-text {
    color: var(--primary);
    font-weight: 500;
}

#imageResult {
    max-width: 100%;
    max-height: 70vh;
    border-radius: var(--border-radius);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
    display: none;
    margin: 0 auto;
    border: 1px solid var(--border-color);
}

.image-actions {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem;
    justify-content: center;
    margin-top: 1.25rem;
}

.image-actions button {
    flex: 1 1 120px;
    max-width: 200px;
}

.btn-download {
    background-color: var(--success);
}

.btn-regenerate {
    background-color: var(--secondary);
}

.btn-copy {
    background-color: var(--accent);
}

.btn-save {
    background-color: var(--primary);
}

.error-message {
    color: var(--error);
    background-color: rgba(239, 83, 80, 0.1);
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 1rem;
    display: none;
}

.image-info {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem;
    justify-content: center;
    margin-top: 1rem;
    font-size: clamp(0.75rem, 2vw, 0.85rem);
    color: var(--text-color);
    opacity: 0.8;
}

.image-info span {
    display: flex;
    align-items: center;
    gap: 0.3rem;
}

.model-tag {
    background-color: rgba(126, 87, 194, 0.1);
    color: var(--primary);
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.75rem;
    font-weight: 500;
}

.advanced-options {
    grid-column: span 1;
    background-color: rgba(126, 87, 194, 0.05);
    padding: 1rem;
    border-radius: 8px;
    margin-top: 0.5rem;
}

.advanced-toggle {
    display: flex;
    align-items: center;
    justify-content: space-between;
    cursor: pointer;
    margin-bottom: 0.5rem;
}

.advanced-content {
    display: none;
    padding-top: 0.5rem;
}

.advanced-options.active .advanced-content {
    display: block;
}

.style-presets {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 0.5rem;
    margin-top: 0.75rem;
}

.style-preset {
    background-color: var(--input-bg);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    padding: 0.5rem;
    text-align: center;
    cursor: pointer;
    transition: var(--transition);
    font-size: clamp(0.7rem, 2vw, 0.8rem);
}

.style-preset:hover {
    border-color: var(--primary);
    color: var(--primary);
}

.style-preset.active {
    background-color: var(--primary);
    color: white;
    border-color: var(--primary);
}

/* Gallery Styles */
.gallery-container {
    margin-top: 2rem;
    border-top: 1px solid var(--gallery-border);
    padding-top: 1.5rem;
}

.gallery-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
}

.gallery-title {
    font-family: 'Montserrat', sans-serif;
    color: var(--primary-dark);
    font-size: 1.2rem;
}

.btn-clear-gallery {
    background-color: var(--error);
    padding: 0.4rem 0.8rem;
    font-size: 0.8rem;
}

.gallery-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 1rem;
    margin-top: 1rem;
}

.gallery-item {
    position: relative;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    transition: var(--transition);
    aspect-ratio: 1/1;
    background-color: var(--gallery-bg);
}

.gallery-item:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
}

.gallery-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.gallery-item-actions {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
    padding: 0.5rem;
    display: flex;
    justify-content: center;
    gap: 0.5rem;
    opacity: 0;
    transition: var(--transition);
}

.gallery-item:hover .gallery-item-actions {
    opacity: 1;
}

.gallery-item-btn {
    background-color: rgba(255,255,255,0.2);
    color: white;
    border: none;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    backdrop-filter: blur(5px);
    transition: var(--transition);
}

.gallery-item-btn:hover {
    background-color: var(--primary);
    transform: scale(1.1);
}

.empty-gallery {
    text-align: center;
    color: #666;
    padding: 2rem;
    font-style: italic;
}

footer {
    text-align: center;
    margin-top: 2rem;
    color: var(--text-color);
    opacity: 0.7;
    font-size: clamp(0.75rem, 2vw, 0.85rem);
}

/* Prompt Controls */
.prompt-controls {
    display: flex;
    justify-content: space-between;
    margin-top: 8px;
}

.btn-enhance {
    background-color: var(--secondary);
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.8rem;
    transition: var(--transition);
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
}

.btn-enhance:hover {
    background-color: var(--primary-dark);
    transform: translateY(-1px);
}

.btn-enhance i {
    font-size: 0.8rem;
}

.btn-enhance .fa-spinner {
    animation: spin 0.8s linear infinite;
}

.size-info-container {
    display: flex;
    justify-content: center;
    margin-top: 0.5rem;
}

.size-info {
    font-size: 0.85rem;
    font-weight: 500;
    padding: 0.25rem 0.75rem;
    border-radius: 12px;
    background-color: rgba(126, 87, 194, 0.1);
}

.size-info.portrait {
    color: #5E35B1;
    background-color: rgba(94, 53, 177, 0.1);
}

.size-info.square {
    color: #26C6DA;
    background-color: rgba(38, 198, 218, 0.1);
}

.size-info.landscape {
    color: #FFA000;
    background-color: rgba(255, 160, 0, 0.1);
}

.note {
    font-size: 14px;
    text-align: center;
    color: #777; 
    margin-top: 10px;
    border-radius: 15px;
    padding: 10px;
    background-color: rgba(255, 0, 0, 0.1);
}

/* Dark mode toggle */
.dark-mode-toggle {
    position: absolute;
    top: 0;
    right: 0;
    background: none;
    border: none;
    color: var(--text-color);
    font-size: 1.2rem;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: var(--transition);
}

.dark-mode-toggle:hover {
    background-color: rgba(126, 87, 194, 0.1);
    color: var(--primary);
}

/* Prompt history dropdown */
.prompt-history {
    position: relative;
    display: inline-block;
}

.prompt-history-btn {
    background-color: var(--secondary);
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.8rem;
    transition: var(--transition);
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    margin-left: 0.5rem;
    margin-bottom:5px;
}

.prompt-history-content {
    display: none;
    position: absolute;
    background-color: var(--card-bg);
    min-width: 250px;
    box-shadow: 0 8px 16px rgba(0,0,0,0.2);
    z-index: 1;
    border-radius: 8px;
    padding: 0.5rem;
    max-height: 300px;
    overflow-y: auto;
    border: 1px solid var(--border-color);
}

.prompt-history-item {
    padding: 0.5rem;
    cursor: pointer;
    border-radius: 4px;
    margin-bottom: 0.25rem;
    font-size: 0.85rem;
    transition: var(--transition);
}

.prompt-history-item:hover {
    background-color: rgba(126, 87, 194, 0.1);
}

.prompt-history.show .prompt-history-content {
    display: block;
}

/* Progress bar */
.progress-container {
    width: 100%;
    height: 6px;
    background-color: rgba(126, 87, 194, 0.1);
    border-radius: 3px;
    margin-top: 0.5rem;
    overflow: hidden;
    display: none;
}

.progress-bar {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, var(--primary), var(--secondary));
    transition: width 0.3s ease;
}

/* Batch generation */
.batch-controls {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.5rem;
}

.batch-input {
    flex: 1;
}

/* New Styles for Enhanced Features */

/* Prompt suggestions */
.prompt-suggestions {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-top: 0.5rem;
}

.prompt-suggestion {
    background-color: rgba(126, 87, 194, 0.1);
    color: var(--primary);
    padding: 0.4rem 0.8rem;
    border-radius: 20px;
    font-size: 0.8rem;
    cursor: pointer;
    transition: var(--transition);
}

.prompt-suggestion:hover {
    background-color: var(--primary);
    color: white;
}

/* Image upscaler */
.upscale-container {
    margin-top: 1rem;
    display: none;
}

.upscale-options {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.5rem;
}

/* Image editor */
.image-editor {
    margin-top: 1rem;
    display: none;
}

.editor-controls {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-top: 0.5rem;
}

.editor-control {
    flex: 1;
    min-width: 120px;
}

/* AI Style Transfer */
.style-transfer {
    margin-top: 1rem;
    display: none;
}

/* Model comparison */
.model-comparison {
    margin-top: 1rem;
    display: none;
}

/* Tutorial tooltips */
.tooltip {
    position: relative;
    display: inline-block;
    cursor: help;
}

.tooltip .tooltiptext {
    visibility: hidden;
    width: 200px;
    background-color: var(--dark);
    color: var(--light);
    text-align: center;
    border-radius: 6px;
    padding: 5px;
    position: absolute;
    z-index: 1;
    bottom: 125%;
    left: 50%;
    margin-left: -100px;
    opacity: 0;
    transition: opacity 0.3s;
    font-size: 0.8rem;
}

.tooltip:hover .tooltiptext {
    visibility: visible;
    opacity: 1;
}

/* AI Assistant */
.ai-assistant {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background-color: var(--primary);
    color: white;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    z-index: 999;
    cursor: pointer;
    transition: var(--transition);
}

.ai-assistant:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
}

.ai-assistant-panel {
    position: fixed;
    bottom: 90px;
    right: 20px;
    width: 300px;
    max-height: 400px;
    background-color: var(--card-bg);
    border-radius: 12px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
    padding: 1rem;
    z-index: 1000;
    display: none;
    flex-direction: column;
    border: 1px solid var(--border-color);
}

.ai-assistant-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
}

.ai-assistant-title {
    font-weight: 600;
    color: var(--primary);
}

.ai-assistant-close {
    background: none;
    border: none;
    color: var(--text-color);
    cursor: pointer;
    font-size: 1.2rem;
}

.ai-assistant-messages {
    flex: 1;
    overflow-y: auto;
    margin-bottom: 1rem;
    padding-right: 0.5rem;
}

.ai-message {
    margin-bottom: 0.75rem;
    padding: 0.5rem;
    border-radius: 8px;
    font-size: 0.9rem;
    line-height: 1.4;
}

.ai-message.user {
    background-color: rgba(126, 87, 194, 0.1);
    align-self: flex-end;
    margin-left: 2rem;
}

.ai-message.assistant {
    background-color: rgba(38, 198, 218, 0.1);
    align-self: flex-start;
    margin-right: 2rem;
}

.ai-assistant-input {
    display: flex;
    gap: 0.5rem;
}

.ai-assistant-input input {
    flex: 1;
    padding: 0.5rem;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    font-size: 0.9rem;
}

.ai-assistant-input button {
    padding: 0.5rem 1rem;
    font-size: 0.9rem;
}

/* Image variations */
.image-variations {
    display: none;
    margin-top: 1rem;
}

.variations-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 1rem;
    margin-top: 1rem;
}

/* Aspect ratio presets */
.aspect-ratio-presets {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.5rem;
}

.aspect-ratio-btn {
    padding: 0.4rem 0.8rem;
    border-radius: 6px;
    color: #222;
    background-color: var(--input-bg);
    border: 1px solid var(--border-color);
    cursor: pointer;
    font-size: 0.8rem;
}

.aspect-ratio-btn.active {
    background-color: var(--primary);
    color: white;
    border-color: var(--primary);
}

/* Prompt templates */
.prompt-templates {
    display: none;
    margin-top: 1rem;
}

.template-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 1rem;
    margin-top: 1rem;
}

.template-card {
    background-color: var(--input-bg);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 1rem;
    cursor: pointer;
    transition: var(--transition);
}

.template-card:hover {
    border-color: var(--primary);
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.template-title {
    font-weight: 600;
    margin-bottom: 0.5rem;
    color: var(--primary);
}

.template-desc {
    font-size: 0.8rem;
    color: var(--text-color);
    opacity: 0.8;
}

/* Image info panel */
.image-info-panel {
    display: none;
    margin-top: 1rem;
    padding: 1rem;
    background-color: var(--input-bg);
    border-radius: 8px;
    border: 1px solid var(--border-color);
}

/* Advanced model settings */
.model-settings {
    display: none;
    margin-top: 1rem;
}

/* Share buttons */
.share-buttons {
    display: flex;
    gap: 0.5rem;
    margin-top: 1rem;
}

.share-btn {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.5rem;
    border-radius: 6px;
    color: white;
    font-size: 0.8rem;
}

.share-fb {
    background-color: #1877F2;
}

.share-twitter {
    background-color: #1DA1F2;
}

.share-pinterest {
    background-color: #E60023;
}

/* Image zoom */
.zoom-container {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0,0,0,0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1001;
    display: none;
}

.zoom-image {
    max-width: 90%;
    max-height: 90%;
    object-fit: contain;
}

.zoom-close {
    position: absolute;
    top: 20px;
    right: 20px;
    color: white;
    font-size: 2rem;
    cursor: pointer;
}

/* Prompt analyzer */
.prompt-analyzer {
    margin-top: 1rem;
    display: none;
}

.analyzer-results {
    margin-top: 0.5rem;
    padding: 0.5rem;
    background-color: var(--input-bg);
    border-radius: 8px;
    border: 1px solid var(--border-color);
}

/* Image filters */
.image-filters {
    display: none;
    margin-top: 1rem;
}

.filter-options {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-top: 0.5rem;
}

.filter-btn {
    padding: 0.4rem 0.8rem;
    border-radius: 6px;
    background-color: var(--input-bg);
    border: 1px solid var(--border-color);
    cursor: pointer;
    font-size: 0.8rem;
}

.filter-btn.active {
    background-color: var(--primary);
    color: white;
    border-color: var(--primary);
}

/* Floating Facebook Button */
.floating-fb-btn {
    position: fixed;
    bottom: 20px;
    left: 20px;
    background-color: #1877F2;
    color: white;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 30px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    z-index: 999;
    transition: var(--transition);
    text-decoration: none;
}

.floating-fb-btn:hover {
    background-color: #166FE5;
    transform: translateY(-3px);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
}

/* Responsive Adjustments */
@media (min-width: 768px) {
    .generator-form {
        grid-template-columns: 1fr 1fr;
    }
    
    .form-group.full-width {
        grid-column: span 2;
    }
    
    .advanced-options {
        grid-column: span 2;
    }
}

@media (max-width: 768px) {
    .container {
        padding: 0.5rem;
        margin: 0.5rem;
        width: calc(100% - 1rem);
    }

    .generator-form {
        grid-template-columns: 1fr;
        gap: 0.5rem;
    }

    .form-group {
        margin-bottom: 0.75rem;
    }

    .style-presets {
        grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
    }

    .aspect-ratio-presets {
        flex-wrap: wrap;
    }

    .aspect-ratio-btn {
        padding: 0.3rem 0.6rem;
        font-size: 0.7rem;
        margin-bottom: 0.3rem;
    }

    .prompt-suggestions {
        flex-wrap: wrap;
    }

    .prompt-suggestion {
        padding: 0.3rem 0.6rem;
        font-size: 0.7rem;
        margin-bottom: 0.3rem;
    }

    .image-actions {
        flex-direction: column;
        align-items: stretch;
    }

    .image-actions button {
        max-width: 100%;
        margin-bottom: 0.5rem;
    }

    .gallery-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    }

    .ai-assistant-panel {
        width: calc(100% - 40px);
        right: 10px;
        bottom: 80px;
        max-height: 60vh;
    }

    .template-grid {
        grid-template-columns: 1fr;
    }

    .editor-controls {
        flex-direction: column;
    }

    .editor-control {
        min-width: 100%;
    }

    .share-buttons {
        flex-direction: column;
    }

    .share-btn {
        margin-bottom: 0.5rem;
    }
}

@media (max-width: 480px) {
    h1 {
        font-size: 1.5rem;
    }

    .subtitle {
        font-size: 0.8rem;
    }

    .style-presets {
        grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
    }

    .prompt-controls {
        flex-direction: column;
        gap: 0.5rem;
    }

    .prompt-controls button {
        width: 100%;
    }

    .prompt-history-btn {
        width: 100%;
        margin-left: 0;
        margin-top: 0.5rem;
    }

    .batch-controls {
        flex-direction: column;
    }

    .batch-input {
        width: 100%;
        margin-bottom: 0.5rem;
    }

    .gallery-header {
        flex-direction: column;
        align-items: flex-start;
    }

    .btn-clear-gallery, .btn-enhance {
        margin-top: 0.5rem;
        width: 100%;
    }

    .image-info {
        flex-direction: column;
        align-items: flex-start;
    }

    .image-info span {
        margin-bottom: 0.3rem;
    }

    /* Perbaikan untuk floating buttons pada mobile */
    .floating-fb-btn, .ai-assistant {
        width: 50px;
        height: 50px;
        font-size: 20px;
        bottom: 15px;
    }

    .floating-fb-btn {
        left: 15px;
    }

    .ai-assistant {
        right: 15px;
    }

    /* Perbaikan untuk dropdown prompt history */
    .prompt-history-content {
        width: 100%;
        left: 0;
        right: 0;
    }

    /* Perbaikan untuk zoom image */
    .zoom-image {
        max-width: 95%;
        max-height: 80vh;
    }
}

/* Perbaikan untuk elemen input pada mobile */
input, select, textarea {
    font-size: 16px !important; /* Mencegah zoom pada iOS */
}
    </style>
</head>
<body>
    <div class="container">
        <header>
            <button class="dark-mode-toggle" id="darkModeToggle" title="Toggle Dark Mode">
                <i class="fas fa-moon"></i>
            </button>
            <h1><i class="fas fa-magic"></i> Kenthir AI Pro</h1>
            <p class="subtitle">Create stunning images with Flux-Turbo technology</p>
        </header>
        
        <div class="generator-form">
            <div class="form-group full-width">
                <label for="prompt"><i class="fas fa-align-left"></i> Describe your image</label>
                <div class="prompt-history">
                    <button class="btn-enhance prompt-history-btn" onclick="togglePromptHistory()">
                        <i class="fas fa-history"></i> History Prompt
                    </button>
                    <div class="prompt-history-content" id="promptHistoryContent"></div>
                </div>
                <div class="input-icon">
                    <i class="fas fa-paint-brush"></i>
                    <textarea id="prompt" placeholder="Example: A majestic lion standing on a cliff at sunset, digital art, highly detailed, cinematic lighting"></textarea>
                </div>
                
                <!-- Prompt Suggestions -->
                <div class="prompt-suggestions" id="promptSuggestions">
                    <div class="prompt-suggestion" onclick="applySuggestion('portrait of a wise old wizard, fantasy art, highly detailed')">Fantasy</div>
                    <div class="prompt-suggestion" onclick="applySuggestion('futuristic city at night, cyberpunk style, neon lights')">Cyberpunk</div>
                    <div class="prompt-suggestion" onclick="applySuggestion('cute anime girl with pink hair, cherry blossoms, studio ghibli style')">Anime</div>
                    <div class="prompt-suggestion" onclick="applySuggestion('majestic tiger in the jungle, photorealistic, national geographic')">Photorealistic</div>
                </div>
                
                <div class="prompt-controls">
                    <button class="btn-clear" onclick="clearPrompt()">
                        <i class="fas fa-eraser"></i> Clear Prompt
                    </button>
                    <button class="btn-enhance" onclick="enhancePrompt()">
                        <i class="fas fa-wand-magic-sparkles"></i> Enhance Prompt
                    </button>
                    <button class="btn-enhance" onclick="analyzePrompt()">
                        <i class="fas fa-search"></i> Analyze
                    </button>
                </div>
                
                <!-- Prompt Analyzer -->
                <div class="prompt-analyzer" id="promptAnalyzer">
                    <div class="analyzer-results" id="analyzerResults"></div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="model"><i class="fas fa-robot"></i> AI Model</label>
                <div class="input-icon">
                    <i class="fas fa-cog"></i>
                    <select id="model">
                        <option value="flux-turbo">Flux-Turbo (Default)</option>
                        <option disabled value="dalle">Dall-E3</option>
                        <option disabled value="midjourney">Midjourney</option>
                        <option disabled value="stable-diffusion">Stable Diffusion XL</option>
                    </select>
                </div>
                
                <!-- Model Settings -->
                <div class="model-settings" id="modelSettings">
                    <div class="form-group">
                        <label for="model-strength">Model Strength</label>
                        <input type="range" id="model-strength" min="0.5" max="1.5" step="0.1" value="1.0" oninput="updateModelStrengthValue()">
                        <div style="text-align: center; margin-top: 0.5rem;">
                            <span id="modelStrengthValue">1.0</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="width"><i class="fas fa-arrows-alt-h"></i> Width</label>
                <div class="input-icon">
                    <i class="fas fa-ruler-horizontal"></i>
                    <input type="number" id="width" value="1024" min="256" max="1792" oninput="updateSizeInfo()">
                </div>
            </div>
            
            <div class="form-group">
                <label for="height"><i class="fas fa-arrows-alt-v"></i> Height</label>
                <div class="input-icon">
                    <i class="fas fa-ruler-vertical"></i>
                    <input type="number" id="height" value="1024" min="256" max="1792" oninput="updateSizeInfo()">
                </div>
                
                <!-- Aspect Ratio Presets -->
                <div class="aspect-ratio-presets">
                    <button class="aspect-ratio-btn" onclick="setAspectRatio(1, 1)">Square</button>
                    <button class="aspect-ratio-btn" onclick="setAspectRatio(9, 16)">Portrait</button>
                    <button class="aspect-ratio-btn" onclick="setAspectRatio(16, 9)">Landscape</button>
                    <button class="aspect-ratio-btn" onclick="setAspectRatio(4, 5)">Instagram</button>
                    <button class="aspect-ratio-btn" onclick="setAspectRatio(3, 2)">Photo</button>
                </div>
                
                <div class="size-info-container">
                    <div class="size-info" id="sizeInfo">Square (1024×1024)</div>
                </div>
                <div class="note"> (1024x1024=Square)
                (1024x1792=Portrait)
                (1792x1024=Landscape)</div>
            </div>
            
            <div class="advanced-options">
                <div class="advanced-toggle" onclick="toggleAdvanced()">
                    <span><i class="fas fa-sliders-h"></i> Advanced Options</span>
                    <i class="fas fa-chevron-down" id="advanced-arrow"></i>
                </div>
                <div class="advanced-content">
                    <div class="form-group">
                        <label for="safe-mode"><i class="fas fa-shield-alt"></i> NSFW</label>
                        <div class="input-icon">
                            <i class="fas fa-toggle-on"></i>
                            <select id="safe-mode">
                                <option value="true">Enabled (Recommended)</option>
                                <option value="false">Disabled</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="seed"><i class="fas fa-fingerprint"></i> Seed (for reproducibility)</label>
                        <div class="input-icon">
                            <i class="fas fa-hashtag"></i>
                            <input type="number" id="seed" placeholder="Leave empty for random">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="steps"><i class="fas fa-tachometer-alt"></i> Steps (quality)</label>
                        <div class="input-icon">
                            <i class="fas fa-step-forward"></i>
                            <input type="range" id="steps" min="20" max="50" value="30" oninput="updateStepsValue()">
                        </div>
                        <div style="text-align: center; margin-top: 0.5rem;">
                            <span id="stepsValue">30</span> steps
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="cfg-scale"><i class="fas fa-sliders-h"></i> Creativity (CFG Scale)</label>
                        <div class="input-icon">
                            <i class="fas fa-lightbulb"></i>
                            <input type="range" id="cfg-scale" min="5" max="15" value="7" step="0.5" oninput="updateCfgValue()">
                        </div>
                        <div style="text-align: center; margin-top: 0.5rem;">
                            <span id="cfgValue">7</span> (Higher = more creative)
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-palette"></i> Style Presets</label>
                        <div class="style-presets">
                            <div class="style-preset" onclick="applyStyle(this, 'Digital Art')">Digital Art</div>
                            <div class="style-preset" onclick="applyStyle(this, 'Photorealistic')">Photorealistic</div>
                            <div class="style-preset" onclick="applyStyle(this, 'Anime')">Anime</div>
                            <div class="style-preset" onclick="applyStyle(this, 'Cyberpunk')">Cyberpunk</div>
                            <div class="style-preset" onclick="applyStyle(this, 'Fantasy')">Fantasy</div>
                            <div class="style-preset" onclick="applyStyle(this, 'Watercolor')">Watercolor</div>
                            <div class="style-preset" onclick="applyStyle(this, 'Oil Painting')">Oil Painting</div>
                            <div class="style-preset" onclick="applyStyle(this, 'Pixel Art')">Pixel Art</div>
                            <div class="style-preset" onclick="applyStyle(this, 'Minimalist')">Minimalist</div>
                            <div class="style-preset" onclick="applyStyle(this, 'Surreal')">Surreal</div>
                            <div class="style-preset" onclick="applyStyle(this, 'Concept Art')">Concept Art</div>
                            <div class="style-preset" onclick="applyStyle(this, 'Comic Book')">Comic Book</div>
                        </div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="negative-prompt"><i class="fas fa-ban"></i> Negative Prompt</label>
                        <div class="input-icon">
                            <i class="fas fa-exclamation-circle"></i>
                            <textarea id="negative-prompt" placeholder="What you don't want in the image (e.g., blurry, distorted, bad anatomy)"></textarea>
                        </div>
                    </div>
                    
                    <!-- Prompt Templates -->
                    <div class="form-group full-width">
                        <label><i class="fas fa-clipboard-list"></i> Prompt Templates</label>
                        <button class="btn-enhance" onclick="togglePromptTemplates()" style="width: 100%;">
                            <i class="fas fa-clipboard"></i> Show Templates
                        </button>
                        
                        <div class="prompt-templates" id="promptTemplates">
                            <div class="template-grid">
                                <div class="template-card" onclick="applyTemplate('Portrait of a [character description], [art style], [lighting], [detailed elements]', 'Portrait Template')">
                                    <div class="template-title">Portrait Template</div>
                                    <div class="template-desc">Structured template for character portraits</div>
                                </div>
                                <div class="template-card" onclick="applyTemplate('A [scene description], [art style], [lighting], [mood], [detailed elements]', 'Scene Template')">
                                    <div class="template-title">Scene Template</div>
                                    <div class="template-desc">Template for creating detailed scenes</div>
                                </div>
                                <div class="template-card" onclick="applyTemplate('[Object/creature] with [features], [art style], [lighting], [background], [detailed elements]', 'Object Template')">
                                    <div class="template-title">Object Template</div>
                                    <div class="template-desc">For objects, creatures, or items</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="form-group full-width" style="text-align: center; margin-top: 0.5rem;">
                <button class="btn-generate" onclick="generateImage()">
                    <i class="fas fa-bolt"></i> Generate Image
                </button>
                <div class="progress-container" id="progressContainer">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                <div class="batch-controls">
                    <input type="number" id="batchCount" min="1" max="4" value="1" class="batch-input" placeholder="Number of images">
                    <button class="btn-enhance" onclick="generateBatch()">
                        <i class="fas fa-layer-group"></i> Generate Batch
                    </button>
                </div>
            </div>
        </div>
        
        <div class="error-message" id="errorMessage"></div>
        
        <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            <p class="loading-text">Generating your artwork...</p>
            <div class="progress-container" style="width: 80%; margin-top: 1rem;">
                <div class="progress-bar" id="loadingProgressBar"></div>
            </div>
        </div>
        
        <div class="result-container">
            <img id="imageResult" alt="Generated image will appear here" onclick="zoomImage(this)">
            
            <div class="image-actions" id="imageActions" style="display: none;">
                <button class="btn-download" onclick="downloadImage()">
                    <i class="fas fa-download"></i> Download
                </button>
                <button class="btn-regenerate" onclick="regenerateImage()">
                    <i class="fas fa-sync-alt"></i> Regenerate
                </button>
                <button class="btn-copy" onclick="copyPrompt()">
                    <i class="fas fa-copy"></i> Copy Prompt
                </button>
                <button class="btn-save" onclick="saveToGallery()">
                    <i class="fas fa-save"></i> Save to Gallery
                </button>
                <button class="btn-enhance" onclick="showVariations()">
                    <i class="fas fa-copy"></i> Variations
                </button>
            </div>
            
            <!-- Image Variations -->
            <div class="image-variations" id="imageVariations">
                <h4>Image Variations</h4>
                <div class="variations-grid" id="variationsGrid"></div>
            </div>
            
            <!-- Image Upscaler -->
            <div class="upscale-container" id="upscaleContainer">
                <h4>Image Upscaler</h4>
                <div class="upscale-options">
                    <button class="btn-enhance" onclick="upscaleImage(2)">
                        <i class="fas fa-expand"></i> 2x Upscale
                    </button>
                    <button class="btn-enhance" onclick="upscaleImage(4)">
                        <i class="fas fa-expand"></i> 4x Upscale
                    </button>
                </div>
            </div>
            
            <!-- Image Editor -->
            <div class="image-editor" id="imageEditor">
                <h4>Image Editor</h4>
                <div class="editor-controls">
                    <div class="editor-control">
                        <label>Brightness</label>
                        <input type="range" id="brightness" min="-100" max="100" value="0" oninput="applyImageFilter()">
                    </div>
                    <div class="editor-control">
                        <label>Contrast</label>
                        <input type="range" id="contrast" min="-100" max="100" value="0" oninput="applyImageFilter()">
                    </div>
                    <div class="editor-control">
                        <label>Saturation</label>
                        <input type="range" id="saturation" min="-100" max="100" value="0" oninput="applyImageFilter()">
                    </div>
                    <button class="btn-enhance" onclick="resetImageFilters()">
                        <i class="fas fa-undo"></i> Reset
                    </button>
                </div>
            </div>
            
            <!-- Image Info Panel -->
            <div class="image-info-panel" id="imageInfoPanel">
                <div class="image-info" id="imageInfo"></div>
                
                <!-- Share Buttons -->
                <div class="share-buttons">
                    <button class="share-btn share-fb" onclick="shareImage('facebook')">
                        <i class="fab fa-facebook-f"></i> Facebook
                    </button>
                    <button class="share-btn share-twitter" onclick="shareImage('twitter')">
                        <i class="fab fa-twitter"></i> Twitter
                    </button>
                    <button class="share-btn share-pinterest" onclick="shareImage('pinterest')">
                        <i class="fab fa-pinterest-p"></i> Pinterest
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Gallery Section -->
        <div class="gallery-container" id="galleryContainer">
            <div class="gallery-header">
                <h3 class="gallery-title"><i class="fas fa-images"></i> Your Gallery</h3>
                <div>
                    <button class="btn-enhance" onclick="exportGallery()" style="margin-right: 0.5rem;">
                        <i class="fas fa-file-export"></i> Export
                    </button>
                    <button class="btn-clear-gallery" onclick="clearGallery()">
                        <i class="fas fa-trash"></i> Clear Gallery
                    </button>
                </div>
            </div>
            <div class="gallery-grid" id="galleryGrid">
                <!-- Gallery items will be added here dynamically -->
            </div>
        </div>
        
        <!-- Floating Facebook Button -->
        <a href="https://web.facebook.com/groups/2790873117754989/" class="floating-fb-btn" target="_blank" rel="noopener noreferrer">
            <i class="fab fa-facebook-f"></i>
        </a>
        
        <!-- AI Assistant Button -->
        <div class="ai-assistant" id="aiAssistantBtn" onclick="toggleAIAssistant()">
            <i class="fas fa-robot"></i>
        </div>
        
        <!-- AI Assistant Panel -->
        <div class="ai-assistant-panel" id="aiAssistantPanel">
            <div class="ai-assistant-header">
                <div class="ai-assistant-title">AI Art Assistant</div>
                <button class="ai-assistant-close" onclick="toggleAIAssistant()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="ai-assistant-messages" id="aiAssistantMessages">
                <div class="ai-message assistant">
                    Hello! I'm your AI Art Assistant. How can I help you with your creative process today?
                </div>
            </div>
            <div class="ai-assistant-input">
                <input type="text" id="aiAssistantInput" placeholder="Ask me about art generation...">
                <button onclick="sendAIMessage()">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
        
        <!-- Image Zoom Container -->
        <div class="zoom-container" id="zoomContainer" onclick="closeZoom()">
            <img class="zoom-image" id="zoomImage">
            <span class="zoom-close"><i class="fas fa-times"></i></span>
        </div>
        
        <footer>
            <p>Powered by Pollinations.AI Flux-Turbo model | &copy; <span id="currentYear"></span> Kenthir AI Art Pro</p>
        </footer>
    </div>

    <script>
// Global variables
let currentImageUrl = '';
let currentPrompt = '';
let currentImageData = null;
let promptHistory = [];
let isGenerating = false;
let batchQueue = [];
let currentBatchItem = 0;
let originalImageFilters = {};
let aiAssistantEnabled = true;

// Initialize on load
document.addEventListener('DOMContentLoaded', function() {
    // Set current year in footer
    document.getElementById('currentYear').textContent = new Date().getFullYear();
    
    // Load gallery and prompt history
    loadGallery();
    loadPromptHistory();
    
    // Set example prompt
    const examples = [
        "A futuristic city floating in the clouds, neon lights, cyberpunk style, 4k detailed",
        "Portrait of a wise old wizard with a long beard, fantasy art, highly detailed",
        "A cute anime girl with pink hair in a cherry blossom garden, studio ghibli style",
        "A majestic tiger in the jungle, photorealistic, national geographic style"
    ];
    
    document.getElementById('prompt').placeholder = `Example: ${examples[Math.floor(Math.random() * examples.length)]}`;
    
    // Initialize dark mode
    initDarkMode();
    
    // Initialize advanced options
    updateStepsValue();
    updateCfgValue();
    updateSizeInfo();
    updateModelStrengthValue();
    
    // Initialize AI assistant if enabled
    if (aiAssistantEnabled) {
        initAIAssistant();
    }
});

// Dark mode functions
function initDarkMode() {
    const darkModeToggle = document.getElementById('darkModeToggle');
    const darkMode = localStorage.getItem('darkMode') === 'true';
    
    if (darkMode) {
        document.body.classList.add('dark-mode');
        darkModeToggle.innerHTML = '<i class="fas fa-sun"></i>';
    }
    
    darkModeToggle.addEventListener('click', toggleDarkMode);
}

function toggleDarkMode() {
    const darkModeToggle = document.getElementById('darkModeToggle');
    const isDark = document.body.classList.toggle('dark-mode');
    
    if (isDark) {
        darkModeToggle.innerHTML = '<i class="fas fa-sun"></i>';
        localStorage.setItem('darkMode', 'true');
    } else {
        darkModeToggle.innerHTML = '<i class="fas fa-moon"></i>';
        localStorage.setItem('darkMode', 'false');
    }
}

// Toggle advanced options
function toggleAdvanced() {
    const advancedOptions = document.querySelector('.advanced-options');
    const arrow = document.getElementById('advanced-arrow');
    
    advancedOptions.classList.toggle('active');
    
    if (advancedOptions.classList.contains('active')) {
        arrow.classList.remove('fa-chevron-down');
        arrow.classList.add('fa-chevron-up');
    } else {
        arrow.classList.remove('fa-chevron-up');
        arrow.classList.add('fa-chevron-down');
    }
}

// Apply style preset to prompt
function applyStyle(button, style) {
    const promptTextarea = document.getElementById('prompt');
    const currentPrompt = promptTextarea.value;
    
    // Remove any existing style tags
    const cleanedPrompt = currentPrompt.replace(/,?\s*(digital art|photorealistic|anime|cyberpunk|fantasy|watercolor|oil painting|pixel art|minimalist|surreal|concept art|comic book)/gi, '');
    
    // Add new style
    promptTextarea.value = `${cleanedPrompt}, ${style.toLowerCase()}`.trim();
    
    // Update active style button
    document.querySelectorAll('.style-preset').forEach(btn => {
        btn.classList.remove('active');
    });
    button.classList.add('active');
}

// Clear prompt
function clearPrompt() {
    document.getElementById('prompt').value = '';
    document.getElementById('promptAnalyzer').style.display = 'none';
}

// Toggle prompt history dropdown
function togglePromptHistory() {
    const promptHistory = document.querySelector('.prompt-history');
    promptHistory.classList.toggle('show');
}

// Toggle prompt templates
function togglePromptTemplates() {
    const promptTemplates = document.getElementById('promptTemplates');
    promptTemplates.style.display = promptTemplates.style.display === 'none' ? 'block' : 'none';
}

// Apply template to prompt
function applyTemplate(template, title) {
    document.getElementById('prompt').value = template;
    showNotification(`Applied "${title}" template`);
    document.getElementById('promptTemplates').style.display = 'none';
}

// Apply suggestion to prompt
function applySuggestion(suggestion) {
    document.getElementById('prompt').value = suggestion;
    showNotification('Prompt suggestion applied');
}

// Load prompt history from localStorage
function loadPromptHistory() {
    promptHistory = JSON.parse(localStorage.getItem('promptHistory')) || [];
    updatePromptHistoryDisplay();
}

// Update prompt history display
function updatePromptHistoryDisplay() {
    const promptHistoryContent = document.getElementById('promptHistoryContent');
    promptHistoryContent.innerHTML = '';
    
    if (promptHistory.length === 0) {
        promptHistoryContent.innerHTML = '<div style="padding: 0.5rem; text-align: center; color: #666;">No history yet</div>';
        return;
    }
    
    // Display in reverse order (newest first)
    [...promptHistory].reverse().forEach((prompt, index) => {
        const item = document.createElement('div');
        item.className = 'prompt-history-item';
        item.textContent = prompt.length > 50 ? prompt.substring(0, 50) + '...' : prompt;
        item.title = prompt;
        item.onclick = function() {
            document.getElementById('prompt').value = prompt;
            togglePromptHistory();
        };
        promptHistoryContent.appendChild(item);
    });
}

// Add prompt to history
function addToPromptHistory(prompt) {
    if (!prompt.trim()) return;
    
    // Remove if already exists
    promptHistory = promptHistory.filter(p => p !== prompt);
    
    // Add to beginning
    promptHistory.unshift(prompt);
    
    // Keep only last 20 prompts
    if (promptHistory.length > 20) {
        promptHistory = promptHistory.slice(0, 20);
    }
    
    // Save to localStorage
    localStorage.setItem('promptHistory', JSON.stringify(promptHistory));
    
    // Update display
    updatePromptHistoryDisplay();
}

// Analyze prompt
function analyzePrompt() {
    const prompt = document.getElementById('prompt').value.trim();
    const analyzer = document.getElementById('promptAnalyzer');
    const results = document.getElementById('analyzerResults');
    
    if (!prompt) {
        showError('Please enter a prompt first!');
        return;
    }
    
    analyzer.style.display = 'block';
    
    // Simple analysis (in a real app, this could use NLP)
    const wordCount = prompt.split(/\s+/).length;
    const hasStyle = /(digital art|photorealistic|anime|cyberpunk|fantasy|watercolor|oil painting|pixel art|minimalist|surreal|concept art|comic book)/i.test(prompt);
    const hasLighting = /(cinematic lighting|volumetric lighting|dramatic lighting|soft lighting|backlit)/i.test(prompt);
    const hasDetails = /(highly detailed|intricate details|4k|8k|ultra detailed)/i.test(prompt);
    
    let analysis = `<strong>Prompt Analysis:</strong><br>`;
    analysis += `• Word count: ${wordCount}<br>`;
    analysis += `• Style specified: ${hasStyle ? '✅' : '❌ (Consider adding an art style)'}<br>`;
    analysis += `• Lighting specified: ${hasLighting ? '✅' : '❌ (Consider adding lighting description)'}<br>`;
    analysis += `• Details specified: ${hasDetails ? '✅' : '❌ (Consider adding detail level)'}<br>`;
    
    // Check for common issues
    if (wordCount < 10) {
        analysis += `<br><strong>Tip:</strong> Longer prompts (10+ words) often produce better results. Try adding more details.`;
    }
    
    if (!hasStyle) {
        analysis += `<br><strong>Tip:</strong> Adding an art style (e.g., "digital art", "photorealistic") helps guide the AI.`;
    }
    
    results.innerHTML = analysis;
}

// Enhance prompt function
async function enhancePrompt() {
    const promptTextarea = document.getElementById('prompt');
    const prompt = promptTextarea.value.trim();
    const enhanceBtn = document.querySelector('.btn-enhance');
    
    if (!prompt) {
        showError('Please enter a prompt first!');
        return;
    }
    
    // Save original state
    const originalText = enhanceBtn.innerHTML;
    
    // Set loading state
    enhanceBtn.innerHTML = '<i class="fas fa-spinner"></i> Enhancing...';
    enhanceBtn.disabled = true;
    
    try {
        // Simulate API call with timeout
        await new Promise(resolve => setTimeout(resolve, 800));
        
        // Example enhancements
        const enhancements = [
            "highly detailed, 4k, sharp focus, studio quality",
            "cinematic lighting, ultra-realistic, volumetric light",
            "digital art, trending on artstation, concept art",
            "concept art, intricate details, matte painting",
            "volumetric lighting, photorealistic, 8k resolution",
            "octane render, ray tracing, global illumination"
        ];
        const selected = enhancements[Math.floor(Math.random() * enhancements.length)];
        promptTextarea.value = `${prompt}, ${selected}`;
        
        showNotification('Prompt enhanced with quality keywords');
        
    } catch (error) {
        console.error('Enhancement error:', error);
        showError('Failed to enhance prompt');
    } finally {
        // Restore original state
        enhanceBtn.innerHTML = originalText;
        enhanceBtn.disabled = false;
    }
}

// Update steps value display
function updateStepsValue() {
    const steps = document.getElementById('steps').value;
    document.getElementById('stepsValue').textContent = steps;
}

// Update CFG scale value display
function updateCfgValue() {
    const cfgScale = document.getElementById('cfg-scale').value;
    document.getElementById('cfgValue').textContent = cfgScale;
}

// Update model strength value
function updateModelStrengthValue() {
    const strength = document.getElementById('model-strength').value;
    document.getElementById('modelStrengthValue').textContent = strength;
}

// Set aspect ratio
function setAspectRatio(widthRatio, heightRatio) {
    const baseSize = 1024;
    const width = baseSize * widthRatio;
    const height = baseSize * heightRatio;
    
    document.getElementById('width').value = Math.round(width);
    document.getElementById('height').value = Math.round(height);
    updateSizeInfo();
    
    // Update active aspect ratio button
    document.querySelectorAll('.aspect-ratio-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');
}

// Updated size info function
function updateSizeInfo() {
    const width = parseInt(document.getElementById('width').value) || 1024;
    const height = parseInt(document.getElementById('height').value) || 1024;
    const sizeInfo = document.getElementById('sizeInfo');
    
    if (width > height) {
        sizeInfo.textContent = `Landscape (${width}×${height})`;
        sizeInfo.className = 'size-info landscape';
    } else if (width < height) {
        sizeInfo.textContent = `Portrait (${width}×${height})`;
        sizeInfo.className = 'size-info portrait';
    } else {
        sizeInfo.textContent = `Square (${width}×${height})`;
        sizeInfo.className = 'size-info square';
    }
}

// Generate batch of images
async function generateBatch() {
    const batchCount = parseInt(document.getElementById('batchCount').value) || 1;
    
    if (batchCount < 1 || batchCount > 4) {
        showError('Batch count must be between 1 and 4');
        return;
    }
    
    if (isGenerating) {
        showError('Please wait for the current generation to complete');
        return;
    }
    
    // Create batch queue
    batchQueue = Array(batchCount).fill().map((_, i) => i + 1);
    currentBatchItem = 0;
    
    // Start batch generation
    await processBatch();
}

// Process batch items one by one
async function processBatch() {
    if (currentBatchItem >= batchQueue.length) {
        // Batch completed
        showNotification(`Batch generation completed (${batchQueue.length} images)`);
        return;
    }
    
    // Update UI to show batch progress
    const progressText = `Generating image ${currentBatchItem + 1} of ${batchQueue.length}`;
    document.querySelector('.loading-text').textContent = progressText;
    
    // Generate current image
    await generateImage();
    
    // After generation completes, process next item
    currentBatchItem++;
    
    // If there are more items in batch, continue
    if (currentBatchItem < batchQueue.length) {
        // Add small delay between generations
        setTimeout(processBatch, 500);
    }
}

// Generate image
async function generateImage() {
    if (isGenerating) {
        showError('Please wait for the current generation to complete');
        return;
    }
    
    const prompt = document.getElementById('prompt').value.trim();
    const model = document.getElementById('model').value;
    const width = document.getElementById('width').value;
    const height = document.getElementById('height').value;
    const seed = document.getElementById('seed').value;
    const NSFW = document.getElementById('safe-mode').value;
    const steps = document.getElementById('steps').value;
    const cfgScale = document.getElementById('cfg-scale').value;
    const negativePrompt = document.getElementById('negative-prompt').value;
    const modelStrength = document.getElementById('model-strength').value;
    
    if (!prompt) {
        showError('Please enter a prompt description first!');
        return;
    }
    
    // Add to prompt history
    addToPromptHistory(prompt);
    
    // Save current prompt
    currentPrompt = prompt;
    
    // Show loading, hide results and errors
    document.getElementById('loading').style.display = 'flex';
    document.getElementById('imageResult').style.display = 'none';
    document.getElementById('imageActions').style.display = 'none';
    document.getElementById('errorMessage').style.display = 'none';
    document.getElementById('progressContainer').style.display = 'block';
    document.getElementById('upscaleContainer').style.display = 'none';
    document.getElementById('imageEditor').style.display = 'none';
    document.getElementById('imageVariations').style.display = 'none';
    
    // Reset progress bar
    updateProgressBar(0);
    updateLoadingProgress(0);
    
    isGenerating = true;
    
    try {
        // Build URL with Flux-Turbo model
        let url = `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt)}`;
        
        // Parameters for Flux-Turbo
        const params = new URLSearchParams();
        params.append('model', model || 'flux-turbo');
        params.append('width', width || 1024);
        params.append('height', height || 1792);
        params.append('nologo', 'true');
        params.append('safe', NSFW || 'true');
        params.append('enhance_prompt', 'true');
        params.append('steps', steps || '30');
        params.append('cfg_scale', cfgScale || '7');
        params.append('strength', modelStrength || '1.0');
        
        if (seed) {
            params.append('seed', seed);
        }
        
        if (negativePrompt) {
            params.append('negative_prompt', negativePrompt);
        }
        
        // Combine parameters
        url += `?${params.toString()}`;
        
        // Add timestamp to avoid caching
        url += `&timestamp=${Date.now()}`;
        
        // Simulate progress (since we can't get real progress from API)
        const progressInterval = setInterval(() => {
            const currentProgress = parseInt(document.getElementById('progressBar').style.width) || 0;
            const newProgress = Math.min(currentProgress + 5, 90);
            updateProgressBar(newProgress);
            updateLoadingProgress(newProgress);
        }, 500);
        
        // Fetch image
        const response = await fetch(url);
        
        clearInterval(progressInterval);
        updateProgressBar(100);
        updateLoadingProgress(100);
        
        if (!response.ok) {
            throw new Error(`Server returned ${response.status}: ${response.statusText}`);
        }
        
        // Get image blob
        const blob = await response.blob();
        currentImageUrl = URL.createObjectURL(blob);
        
        // Store image data for saving to gallery
        currentImageData = {
            url: currentImageUrl,
            prompt: prompt,
            model: model,
            width: width,
            height: height,
            seed: seed || 'random',
            steps: steps,
            cfgScale: cfgScale,
            negativePrompt: negativePrompt,
            date: new Date().toISOString(),
            strength: modelStrength
        };
        
        // Store original image data for filters
        originalImageFilters = {
            brightness: 0,
            contrast: 0,
            saturation: 0
        };
        
        // Display image
        const imageElement = document.getElementById('imageResult');
        imageElement.onload = function() {
            // Adjust display for portrait images
            if (this.naturalHeight > this.naturalWidth) {
                this.style.maxHeight = '70vh';
                this.style.width = 'auto';
            } else {
                this.style.maxWidth = '100%';
                this.style.height = 'auto';
            }
        };
        imageElement.src = currentImageUrl;
        imageElement.style.display = 'block';
        
        // Show image actions
        document.getElementById('imageActions').style.display = 'flex';
        
        // Show editor and upscaler options
        document.getElementById('upscaleContainer').style.display = 'block';
        document.getElementById('imageEditor').style.display = 'block';
        document.getElementById('imageInfoPanel').style.display = 'block';
        
        // Display image info
        document.getElementById('imageInfo').innerHTML = `
            <span><i class="fas fa-robot"></i> Model: <span class="model-tag">${model}</span></span>
            <span><i class="fas fa-expand"></i> Size: ${width}×${height}px</span>
            <span><i class="fas fa-fingerprint"></i> Seed: ${seed || 'random'}</span>
            <span><i class="fas fa-tachometer-alt"></i> Steps: ${steps}</span>
            <span><i class="fas fa-sliders-h"></i> CFG: ${cfgScale}</span>
            <span><i class="fas fa-bolt"></i> Strength: ${modelStrength}</span>
            <span><i class="fas fa-shield-alt"></i> NSFW: ${NSFW === 'true' ? 'On' : 'Off'}</span>
        `;
        
        // Automatically save to gallery when in batch mode
        if (batchQueue.length > 1) {
            saveToGallery();
        }
        
    } catch (error) {
        console.error('Error:', error);
        showError(`Failed to generate image: ${error.message}`);
    } finally {
        // Hide loading and progress
        document.getElementById('loading').style.display = 'none';
        document.getElementById('progressContainer').style.display = 'none';
        isGenerating = false;
    }
}

// Show image variations
async function showVariations() {
    if (!currentImageUrl) return;
    
    const variationsGrid = document.getElementById('variationsGrid');
    variationsGrid.innerHTML = '';
    
    document.getElementById('imageVariations').style.display = 'block';
    
    // Show loading for variations
    variationsGrid.innerHTML = '<div style="grid-column: 1/-1; text-align: center; padding: 2rem;">Generating variations...</div>';
    
    try {
        // Simulate generating variations (in a real app, this would call an API)
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        // Clear loading
        variationsGrid.innerHTML = '';
        
        // Create 4 variations
        for (let i = 0; i < 4; i++) {
            const variationUrl = currentImageUrl + `?variation=${i}&seed=${Math.floor(Math.random() * 100000)}`;
            
            const variationItem = document.createElement('div');
            variationItem.className = 'gallery-item';
            variationItem.innerHTML = `
                <img src="${variationUrl}" alt="Variation ${i+1}" class="gallery-img" onclick="selectVariation(this)">
                <div class="gallery-item-actions">
                    <button class="gallery-item-btn" onclick="downloadVariation('${variationUrl}')" title="Download">
                        <i class="fas fa-download"></i>
                    </button>
                </div>
            `;
            variationsGrid.appendChild(variationItem);
        }
    } catch (error) {
        console.error('Error generating variations:', error);
        showError('Failed to generate variations');
    }
}

// Select variation as main image
function selectVariation(imgElement) {
    document.getElementById('imageResult').src = imgElement.src;
    currentImageUrl = imgElement.src;
    
    // Update current image data
    if (currentImageData) {
        currentImageData.url = imgElement.src;
        currentImageData.seed = Math.floor(Math.random() * 100000);
    }
}

// Download variation
function downloadVariation(url) {
    const link = document.createElement('a');
    link.href = url;
    link.download = `ai-art-variation-${Date.now()}.png`;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}

// Upscale image
async function upscaleImage(scale) {
    if (!currentImageUrl) return;
    
    showNotification(`Upscaling image ${scale}x... (This is a simulation in demo)`);
    
    // In a real app, this would call an upscaling API
    await new Promise(resolve => setTimeout(resolve, 1500));
    
    // Simulate upscaled image
    const upscaledUrl = currentImageUrl + `?upscale=${scale}`;
    
    // Display upscaled image
    document.getElementById('imageResult').src = upscaledUrl;
    currentImageUrl = upscaledUrl;
    
    showNotification(`Image upscaled ${scale}x`);
}

// Apply image filters
function applyImageFilter() {
    const imageElement = document.getElementById('imageResult');
    if (!imageElement || !currentImageUrl) return;
    
    const brightness = document.getElementById('brightness').value;
    const contrast = document.getElementById('contrast').value;
    const saturation = document.getElementById('saturation').value;
    
    imageElement.style.filter = `
        brightness(${100 + parseInt(brightness)}%)
        contrast(${100 + parseInt(contrast)}%)
        saturate(${100 + parseInt(saturation)}%)
    `;
}

// Reset image filters
function resetImageFilters() {
    document.getElementById('brightness').value = 0;
    document.getElementById('contrast').value = 0;
    document.getElementById('saturation').value = 0;
    
    const imageElement = document.getElementById('imageResult');
    if (imageElement) {
        imageElement.style.filter = 'none';
    }
}

// Zoom image
function zoomImage(imgElement) {
    const zoomContainer = document.getElementById('zoomContainer');
    const zoomImage = document.getElementById('zoomImage');
    
    zoomImage.src = imgElement.src;
    zoomContainer.style.display = 'flex';
}

// Close zoom
function closeZoom() {
    document.getElementById('zoomContainer').style.display = 'none';
}

// Share image
function shareImage(platform) {
    if (!currentImageUrl) return;
    
    let shareUrl = '';
    const text = `Check out this AI-generated image: ${currentPrompt}`;
    
    switch (platform) {
        case 'facebook':
            shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(currentImageUrl)}&quote=${encodeURIComponent(text)}`;
            break;
        case 'twitter':
            shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(currentImageUrl)}`;
            break;
        case 'pinterest':
            shareUrl = `https://pinterest.com/pin/create/button/?url=${encodeURIComponent(currentImageUrl)}&description=${encodeURIComponent(text)}`;
            break;
    }
    
    window.open(shareUrl, '_blank', 'width=600,height=400');
}

// Update progress bar
function updateProgressBar(percent) {
    document.getElementById('progressBar').style.width = `${percent}%`;
}

// Update loading progress bar
function updateLoadingProgress(percent) {
    document.getElementById('loadingProgressBar').style.width = `${percent}%`;
}

// Download image
function downloadImage() {
    if (!currentImageUrl) return;
    
    const link = document.createElement('a');
    link.href = currentImageUrl;
    link.download = `ai-art-${Date.now()}.png`;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}

// Regenerate image
function regenerateImage() {
    // Change seed to force new generation
    const seedInput = document.getElementById('seed');
    if (seedInput.value) {
        seedInput.value = Math.floor(Math.random() * 1000000);
    }
    generateImage();
}

// Copy prompt to clipboard
function copyPrompt() {
    if (!currentPrompt) return;
    
    navigator.clipboard.writeText(currentPrompt)
        .then(() => {
            const btn = event.target.closest('button');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
            setTimeout(() => {
                btn.innerHTML = originalText;
            }, 2000);
        })
        .catch(err => {
            console.error('Failed to copy prompt:', err);
        });
}

// Save image to gallery
function saveToGallery() {
    if (!currentImageData) return;
    
    // Get existing gallery or create new array
    const gallery = JSON.parse(localStorage.getItem('aiArtGallery')) || [];
    
    // Add new image data
    gallery.push(currentImageData);
    
    // Save to localStorage
    localStorage.setItem('aiArtGallery', JSON.stringify(gallery));
    
    // Update gallery display
    loadGallery();
    
    // Show confirmation
    showNotification('Image saved to gallery!');
}

// Export gallery as JSON
function exportGallery() {
    const gallery = JSON.parse(localStorage.getItem('aiArtGallery')) || [];
    
    if (gallery.length === 0) {
        showError('Gallery is empty, nothing to export');
        return;
    }
    
    const dataStr = JSON.stringify(gallery, null, 2);
    const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
    
    const link = document.createElement('a');
    link.href = dataUri;
    link.download = `ai-art-gallery-${new Date().toISOString()}.json`;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}

// Load gallery from localStorage
function loadGallery() {
    const galleryGrid = document.getElementById('galleryGrid');
    const gallery = JSON.parse(localStorage.getItem('aiArtGallery')) || [];
    
    // Clear existing gallery items
    galleryGrid.innerHTML = '';
    
    if (gallery.length === 0) {
        galleryGrid.innerHTML = '<div class="empty-gallery">Your gallery is empty. Generate and save some images!</div>';
        return;
    }
    
    // Add each gallery item
    gallery.forEach((item, index) => {
        const galleryItem = document.createElement('div');
        galleryItem.className = 'gallery-item';
        galleryItem.innerHTML = `
            <img src="${item.url}" alt="${item.prompt}" class="gallery-img" onclick="viewGalleryItem(${index})">
            <div class="gallery-item-actions">
                <button class="gallery-item-btn" onclick="downloadGalleryImage('${item.url}')" title="Download">
                    <i class="fas fa-download"></i>
                </button>
                <button class="gallery-item-btn" onclick="viewGalleryItem(${index})" title="View Details">
                    <i class="fas fa-eye"></i>
                </button>
                <button class="gallery-item-btn" onclick="deleteGalleryItem(${index})" title="Delete">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        `;
        galleryGrid.appendChild(galleryItem);
    });
}

// View gallery item details
function viewGalleryItem(index) {
    const gallery = JSON.parse(localStorage.getItem('aiArtGallery')) || [];
    const item = gallery[index];
    
    if (!item) return;
    
    // Display the image in the main view
    document.getElementById('imageResult').src = item.url;
    document.getElementById('imageResult').style.display = 'block';
    
    // Show image actions
    document.getElementById('imageActions').style.display = 'flex';
    
    // Show editor and upscaler options
    document.getElementById('upscaleContainer').style.display = 'block';
    document.getElementById('imageEditor').style.display = 'block';
    document.getElementById('imageInfoPanel').style.display = 'block';
    document.getElementById('imageVariations').style.display = 'none';
    
    // Display image info
    document.getElementById('imageInfo').innerHTML = `
        <span><i class="fas fa-robot"></i> Model: <span class="model-tag">${item.model}</span></span>
        <span><i class="fas fa-expand"></i> Size: ${item.width}×${item.height}px</span>
        <span><i class="fas fa-fingerprint"></i> Seed: ${item.seed}</span>
        ${item.steps ? `<span><i class="fas fa-tachometer-alt"></i> Steps: ${item.steps}</span>` : ''}
        ${item.cfgScale ? `<span><i class="fas fa-sliders-h"></i> CFG: ${item.cfgScale}</span>` : ''}
        ${item.strength ? `<span><i class="fas fa-bolt"></i> Strength: ${item.strength}</span>` : ''}
        <span><i class="fas fa-calendar"></i> ${new Date(item.date).toLocaleString()}</span>
    `;
    
    // Set current image data
    currentImageData = item;
    currentImageUrl = item.url;
    currentPrompt = item.prompt;
    
    // Scroll to top
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

// Download image from gallery
function downloadGalleryImage(url) {
    const link = document.createElement('a');
    link.href = url;
    link.download = `ai-art-gallery-${Date.now()}.png`;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}

// Delete item from gallery
function deleteGalleryItem(index) {
    if (!confirm('Are you sure you want to delete this image from your gallery?')) return;
    
    const gallery = JSON.parse(localStorage.getItem('aiArtGallery')) || [];
    gallery.splice(index, 1);
    localStorage.setItem('aiArtGallery', JSON.stringify(gallery));
    loadGallery();
    
    showNotification('Image deleted from gallery');
}

// Clear entire gallery
function clearGallery() {
    if (!confirm('Are you sure you want to clear your entire gallery? This cannot be undone.')) return;
    
    localStorage.removeItem('aiArtGallery');
    loadGallery();
    
    showNotification('Gallery cleared');
}

// AI Assistant Functions
function initAIAssistant() {
    // Add welcome message
    addAIMessage('assistant', 'Hello! I\'m your AI Art Assistant. How can I help you with your creative process today?');
}

function toggleAIAssistant() {
    const panel = document.getElementById('aiAssistantPanel');
    panel.style.display = panel.style.display === 'none' ? 'flex' : 'none';
}

function addAIMessage(role, message) {
    const messagesContainer = document.getElementById('aiAssistantMessages');
    const messageElement = document.createElement('div');
    messageElement.className = `ai-message ${role}`;
    messageElement.textContent = message;
    messagesContainer.appendChild(messageElement);
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
}

function sendAIMessage() {
    const input = document.getElementById('aiAssistantInput');
    const message = input.value.trim();
    
    if (!message) return;
    
    // Add user message
    addAIMessage('user', message);
    input.value = '';
    
    // Simulate AI response
    setTimeout(() => {
        const responses = [
            "For that concept, I recommend using a 'fantasy art' style with 'cinematic lighting' for dramatic effect.",
            "Try adding more descriptive details about the environment and lighting to get better results.",
            "That prompt might work well with the 'digital art' style preset and a CFG scale around 7-8.",
            "Consider using negative prompts like 'blurry, distorted, bad anatomy' to improve image quality.",
            "For that idea, the 'photorealistic' style with '8k resolution' in the prompt would work well."
        ];
        
        const randomResponse = responses[Math.floor(Math.random() * responses.length)];
        addAIMessage('assistant', randomResponse);
    }, 1000);
}

// Show notification
function showNotification(message) {
    const notification = document.createElement('div');
    notification.style.position = 'fixed';
    notification.style.bottom = '20px';
    notification.style.right = '20px';
    notification.style.backgroundColor = 'var(--success)';
    notification.style.color = 'white';
    notification.style.padding = '10px 20px';
    notification.style.borderRadius = '8px';
    notification.style.boxShadow = '0 4px 8px rgba(0,0,0,0.2)';
    notification.style.zIndex = '1000';
    notification.innerHTML = `<i class="fas fa-check-circle"></i> ${message}`;
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.opacity = '0';
        notification.style.transition = 'opacity 0.5s ease';
        setTimeout(() => {
            document.body.removeChild(notification);
        }, 500);
    }, 3000);
}

// Show error message
function showError(message) {
    const errorElement = document.getElementById('errorMessage');
    errorElement.textContent = message;
    errorElement.style.display = 'block';
    
    // Hide after 5 seconds
    setTimeout(() => {
        errorElement.style.display = 'none';
    }, 5000);
}

// Handle Enter key in AI assistant
document.getElementById('aiAssistantInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        sendAIMessage();
    }
});
    </script>
</body>
</html>
